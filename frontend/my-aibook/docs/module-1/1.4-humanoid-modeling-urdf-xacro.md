---
sidebar_position: 4
---

# Chapter 1.4: Humanoid Modeling with URDF & Xacro

## Learning Objectives
- Create detailed humanoid robot models using URDF
- Implement parametric designs with Xacro macros
- Add sensors and actuators to humanoid models
- Validate kinematic chains and joint limits

## URDF Fundamentals for Humanoids

Unified Robot Description Format (URDF) is the standard for describing robot models in ROS. For humanoid robots, the complexity increases due to multiple degrees of freedom and anthropomorphic structure:

```xml
<?xml version="1.0"?>
<robot name="humanoid_robot" xmlns:xacro="http://www.ros.org/wiki/xacro">
  <!-- Material definitions -->
  <material name="black">
    <color rgba="0.0 0.0 0.0 1.0"/>
  </material>
  <material name="blue">
    <color rgba="0.0 0.0 0.8 1.0"/>
  </material>
  <material name="green">
    <color rgba="0.0 0.8 0.0 1.0"/>
  </material>
  <material name="grey">
    <color rgba="0.5 0.5 0.5 1.0"/>
  </material>
  <material name="orange">
    <color rgba="1.0 0.423529411765 0.0392156862745 1.0"/>
  </material>
  <material name="brown">
    <color rgba="0.870588235294 0.811764705882 0.764705882353 1.0"/>
  </material>
  <material name="red">
    <color rgba="0.8 0.0 0.0 1.0"/>
  </material>
  <material name="white">
    <color rgba="1.0 1.0 1.0 1.0"/>
  </material>

  <!-- Base link - pelvis -->
  <link name="base_link">
    <visual>
      <geometry>
        <box size="0.3 0.2 0.15"/>
      </geometry>
      <material name="grey"/>
    </visual>
    <collision>
      <geometry>
        <box size="0.3 0.2 0.15"/>
      </geometry>
    </collision>
    <inertial>
      <mass value="10.0"/>
      <inertia ixx="0.1" ixy="0.0" ixz="0.0" iyy="0.2" iyz="0.0" izz="0.15"/>
    </inertial>
  </link>

  <!-- Torso -->
  <joint name="torso_joint" type="fixed">
    <parent link="base_link"/>
    <child link="torso_link"/>
    <origin xyz="0 0 0.1" rpy="0 0 0"/>
  </joint>

  <link name="torso_link">
    <visual>
      <geometry>
        <box size="0.25 0.15 0.4"/>
      </geometry>
      <material name="orange"/>
    </visual>
    <collision>
      <geometry>
        <box size="0.25 0.15 0.4"/>
      </geometry>
    </collision>
    <inertial>
      <mass value="8.0"/>
      <inertia ixx="0.2" ixy="0.0" ixz="0.0" iyy="0.3" iyz="0.0" izz="0.25"/>
    </inertial>
  </link>

  <!-- Head -->
  <joint name="neck_joint" type="revolute">
    <parent link="torso_link"/>
    <child link="head_link"/>
    <origin xyz="0 0 0.25" rpy="0 0 0"/>
    <axis xyz="0 1 0"/>
    <limit lower="-0.5" upper="0.5" effort="10.0" velocity="1.0"/>
  </joint>

  <link name="head_link">
    <visual>
      <geometry>
        <sphere radius="0.1"/>
      </geometry>
      <material name="skin"/>
    </visual>
    <collision>
      <geometry>
        <sphere radius="0.1"/>
      </geometry>
    </collision>
    <inertial>
      <mass value="2.0"/>
      <inertia ixx="0.02" ixy="0.0" ixz="0.0" iyy="0.02" iyz="0.0" izz="0.02"/>
    </inertial>
  </link>

  <!-- Left Leg -->
  <joint name="left_hip_joint" type="revolute">
    <parent link="base_link"/>
    <child link="left_hip_link"/>
    <origin xyz="-0.1 0 -0.05" rpy="0 0 0"/>
    <axis xyz="0 0 1"/>
    <limit lower="-1.0" upper="1.0" effort="50.0" velocity="2.0"/>
  </joint>

  <link name="left_hip_link">
    <visual>
      <geometry>
        <cylinder radius="0.05" length="0.1"/>
      </geometry>
      <material name="blue"/>
    </visual>
    <collision>
      <geometry>
        <cylinder radius="0.05" length="0.1"/>
      </geometry>
    </collision>
    <inertial>
      <mass value="1.5"/>
      <inertia ixx="0.005" ixy="0.0" ixz="0.0" iyy="0.005" iyz="0.0" izz="0.0025"/>
    </inertial>
  </link>

  <joint name="left_knee_joint" type="revolute">
    <parent link="left_hip_link"/>
    <child link="left_knee_link"/>
    <origin xyz="0 0 -0.2" rpy="0 0 0"/>
    <axis xyz="0 1 0"/>
    <limit lower="0" upper="2.5" effort="50.0" velocity="2.0"/>
  </joint>

  <link name="left_knee_link">
    <visual>
      <geometry>
        <cylinder radius="0.05" length="0.3"/>
      </geometry>
      <material name="blue"/>
    </visual>
    <collision>
      <geometry>
        <cylinder radius="0.05" length="0.3"/>
      </geometry>
    </collision>
    <inertial>
      <mass value="2.0"/>
      <inertia ixx="0.01" ixy="0.0" ixz="0.0" iyy="0.01" iyz="0.0" izz="0.005"/>
    </inertial>
  </link>

  <joint name="left_ankle_joint" type="revolute">
    <parent link="left_knee_link"/>
    <child link="left_foot_link"/>
    <origin xyz="0 0 -0.3" rpy="0 0 0"/>
    <axis xyz="0 0 1"/>
    <limit lower="-0.5" upper="0.5" effort="20.0" velocity="1.0"/>
  </joint>

  <link name="left_foot_link">
    <visual>
      <geometry>
        <box size="0.2 0.1 0.05"/>
      </geometry>
      <material name="black"/>
    </visual>
    <collision>
      <geometry>
        <box size="0.2 0.1 0.05"/>
      </geometry>
    </collision>
    <inertial>
      <mass value="1.0"/>
      <inertia ixx="0.001" ixy="0.0" ixz="0.0" iyy="0.002" iyz="0.0" izz="0.0015"/>
    </inertial>
  </link>

  <!-- Right Leg (mirror of left leg) -->
  <joint name="right_hip_joint" type="revolute">
    <parent link="base_link"/>
    <child link="right_hip_link"/>
    <origin xyz="0.1 0 -0.05" rpy="0 0 0"/>
    <axis xyz="0 0 1"/>
    <limit lower="-1.0" upper="1.0" effort="50.0" velocity="2.0"/>
  </joint>

  <link name="right_hip_link">
    <visual>
      <geometry>
        <cylinder radius="0.05" length="0.1"/>
      </geometry>
      <material name="blue"/>
    </visual>
    <collision>
      <geometry>
        <cylinder radius="0.05" length="0.1"/>
      </geometry>
    </collision>
    <inertial>
      <mass value="1.5"/>
      <inertia ixx="0.005" ixy="0.0" ixz="0.0" iyy="0.005" iyz="0.0" izz="0.0025"/>
    </inertial>
  </link>

  <joint name="right_knee_joint" type="revolute">
    <parent link="right_hip_link"/>
    <child link="right_knee_link"/>
    <origin xyz="0 0 -0.2" rpy="0 0 0"/>
    <axis xyz="0 1 0"/>
    <limit lower="0" upper="2.5" effort="50.0" velocity="2.0"/>
  </joint>

  <link name="right_knee_link">
    <visual>
      <geometry>
        <cylinder radius="0.05" length="0.3"/>
      </geometry>
      <material name="blue"/>
    </visual>
    <collision>
      <geometry>
        <cylinder radius="0.05" length="0.3"/>
      </geometry>
    </collision>
    <inertial>
      <mass value="2.0"/>
      <inertia ixx="0.01" ixy="0.0" ixz="0.0" iyy="0.01" iyz="0.0" izz="0.005"/>
    </inertial>
  </link>

  <joint name="right_ankle_joint" type="revolute">
    <parent link="right_knee_link"/>
    <child link="right_foot_link"/>
    <origin xyz="0 0 -0.3" rpy="0 0 0"/>
    <axis xyz="0 0 1"/>
    <limit lower="-0.5" upper="0.5" effort="20.0" velocity="1.0"/>
  </joint>

  <link name="right_foot_link">
    <visual>
      <geometry>
        <box size="0.2 0.1 0.05"/>
      </geometry>
      <material name="black"/>
    </visual>
    <collision>
      <geometry>
        <box size="0.2 0.1 0.05"/>
      </geometry>
    </collision>
    <inertial>
      <mass value="1.0"/>
      <inertia ixx="0.001" ixy="0.0" ixz="0.0" iyy="0.002" iyz="0.0" izz="0.0015"/>
    </inertial>
  </link>

  <!-- Left Arm -->
  <joint name="left_shoulder_joint" type="revolute">
    <parent link="torso_link"/>
    <child link="left_shoulder_link"/>
    <origin xyz="-0.15 0 0.1" rpy="0 0 0"/>
    <axis xyz="0 1 0"/>
    <limit lower="-1.57" upper="1.57" effort="20.0" velocity="1.5"/>
  </joint>

  <link name="left_shoulder_link">
    <visual>
      <geometry>
        <cylinder radius="0.04" length="0.1"/>
      </geometry>
      <material name="green"/>
    </visual>
    <collision>
      <geometry>
        <cylinder radius="0.04" length="0.1"/>
      </geometry>
    </collision>
    <inertial>
      <mass value="1.0"/>
      <inertia ixx="0.002" ixy="0.0" ixz="0.0" iyy="0.002" iyz="0.0" izz="0.001"/>
    </inertial>
  </link>

  <joint name="left_elbow_joint" type="revolute">
    <parent link="left_shoulder_link"/>
    <child link="left_elbow_link"/>
    <origin xyz="0 0 -0.15" rpy="0 0 0"/>
    <axis xyz="1 0 0"/>
    <limit lower="-2.0" upper="2.0" effort="20.0" velocity="1.5"/>
  </joint>

  <link name="left_elbow_link">
    <visual>
      <geometry>
        <cylinder radius="0.03" length="0.25"/>
      </geometry>
      <material name="green"/>
    </visual>
    <collision>
      <geometry>
        <cylinder radius="0.03" length="0.25"/>
      </geometry>
    </collision>
    <inertial>
      <mass value="1.5"/>
      <inertia ixx="0.005" ixy="0.0" ixz="0.0" iyy="0.005" iyz="0.0" izz="0.001"/>
    </inertial>
  </link>

  <joint name="left_wrist_joint" type="revolute">
    <parent link="left_elbow_link"/>
    <child link="left_hand_link"/>
    <origin xyz="0 0 -0.25" rpy="0 0 0"/>
    <axis xyz="0 1 0"/>
    <limit lower="-1.57" upper="1.57" effort="10.0" velocity="1.0"/>
  </joint>

  <link name="left_hand_link">
    <visual>
      <geometry>
        <box size="0.1 0.08 0.08"/>
      </geometry>
      <material name="skin"/>
    </visual>
    <collision>
      <geometry>
        <box size="0.1 0.08 0.08"/>
      </geometry>
    </collision>
    <inertial>
      <mass value="0.5"/>
      <inertia ixx="0.0005" ixy="0.0" ixz="0.0" iyy="0.0006" iyz="0.0" izz="0.0006"/>
    </inertial>
  </link>

  <!-- Right Arm (mirror of left arm) -->
  <joint name="right_shoulder_joint" type="revolute">
    <parent link="torso_link"/>
    <child link="right_shoulder_link"/>
    <origin xyz="0.15 0 0.1" rpy="0 0 0"/>
    <axis xyz="0 1 0"/>
    <limit lower="-1.57" upper="1.57" effort="20.0" velocity="1.5"/>
  </joint>

  <link name="right_shoulder_link">
    <visual>
      <geometry>
        <cylinder radius="0.04" length="0.1"/>
      </geometry>
      <material name="green"/>
    </visual>
    <collision>
      <geometry>
        <cylinder radius="0.04" length="0.1"/>
      </geometry>
    </collision>
    <inertial>
      <mass value="1.0"/>
      <inertia ixx="0.002" ixy="0.0" ixz="0.0" iyy="0.002" iyz="0.0" izz="0.001"/>
    </inertial>
  </link>

  <joint name="right_elbow_joint" type="revolute">
    <parent link="right_shoulder_link"/>
    <child link="right_elbow_link"/>
    <origin xyz="0 0 -0.15" rpy="0 0 0"/>
    <axis xyz="1 0 0"/>
    <limit lower="-2.0" upper="2.0" effort="20.0" velocity="1.5"/>
  </joint>

  <link name="right_elbow_link">
    <visual>
      <geometry>
        <cylinder radius="0.03" length="0.25"/>
      </geometry>
      <material name="green"/>
    </visual>
    <collision>
      <geometry>
        <cylinder radius="0.03" length="0.25"/>
      </geometry>
    </collision>
    <inertial>
      <mass value="1.5"/>
      <inertia ixx="0.005" ixy="0.0" ixz="0.0" iyy="0.005" iyz="0.0" izz="0.001"/>
    </inertial>
  </link>

  <joint name="right_wrist_joint" type="revolute">
    <parent link="right_elbow_link"/>
    <child link="right_hand_link"/>
    <origin xyz="0 0 -0.25" rpy="0 0 0"/>
    <axis xyz="0 1 0"/>
    <limit lower="-1.57" upper="1.57" effort="10.0" velocity="1.0"/>
  </joint>

  <link name="right_hand_link">
    <visual>
      <geometry>
        <box size="0.1 0.08 0.08"/>
      </geometry>
      <material name="skin"/>
    </visual>
    <collision>
      <geometry>
        <box size="0.1 0.08 0.08"/>
      </geometry>
    </collision>
    <inertial>
      <mass value="0.5"/>
      <inertia ixx="0.0005" ixy="0.0" ixz="0.0" iyy="0.0006" iyz="0.0" izz="0.0006"/>
    </inertial>
  </link>
</robot>
```

## Xacro Macros for Parametric Design

Xacro allows for parameterized robot models that can be easily customized:

```xml
<?xml version="1.0"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro" name="humanoid_xacro">

  <!-- Properties -->
  <xacro:property name="M_PI" value="3.1415926535897931" />
  <xacro:property name="body_height" value="0.8" />
  <xacro:property name="body_width" value="0.25" />
  <xacro:property name="body_depth" value="0.15" />
  <xacro:property name="leg_length" value="0.7" />
  <xacro:property name="arm_length" value="0.5" />

  <!-- Macro for humanoid link with standardized properties -->
  <xacro:macro name="humanoid_link" params="name mass visual_geometry collision_geometry *inertial_values">
    <link name="${name}">
      <visual>
        <geometry>
          <xacro:insert_block name="visual_geometry"/>
        </geometry>
        <material name="grey"/>
      </visual>
      <collision>
        <geometry>
          <xacro:insert_block name="collision_geometry"/>
        </geometry>
      </collision>
      <xacro:insert_block name="inertial_values"/>
    </link>
  </xacro:macro>

  <!-- Macro for humanoid joint -->
  <xacro:macro name="humanoid_joint" params="name type parent child origin_xyz origin_rpy axis_xyz lower upper effort velocity">
    <joint name="${name}" type="${type}">
      <parent link="${parent}"/>
      <child link="${child}"/>
      <origin xyz="${origin_xyz}" rpy="${origin_rpy}"/>
      <xacro:if value="${type != 'fixed'}">
        <axis xyz="${axis_xyz}"/>
        <limit lower="${lower}" upper="${upper}" effort="${effort}" velocity="${velocity}"/>
      </xacro:if>
    </joint>
  </xacro:macro>

  <!-- Macro for humanoid leg -->
  <xacro:macro name="humanoid_leg" params="side hip_xyz knee_xyz ankle_xyz">
    <xacro:humanoid_joint name="${side}_hip_joint" type="revolute"
                          parent="base_link" child="${side}_hip_link"
                          origin_xyz="${hip_xyz}" origin_rpy="0 0 0"
                          axis_xyz="0 0 1" lower="-1.0" upper="1.0" effort="50.0" velocity="2.0"/>

    <xacro:humanoid_link name="${side}_hip_link" mass="1.5">
      <visual_geometry>
        <cylinder radius="0.05" length="0.1"/>
      </visual_geometry>
      <collision_geometry>
        <cylinder radius="0.05" length="0.1"/>
      </collision_geometry>
      <inertial_values>
        <inertial>
          <mass value="1.5"/>
          <inertia ixx="0.005" ixy="0.0" ixz="0.0" iyy="0.005" iyz="0.0" izz="0.0025"/>
        </inertial>
      </inertial_values>
    </xacro:humanoid_link>

    <xacro:humanoid_joint name="${side}_knee_joint" type="revolute"
                          parent="${side}_hip_link" child="${side}_knee_link"
                          origin_xyz="${knee_xyz}" origin_rpy="0 0 0"
                          axis_xyz="0 1 0" lower="0" upper="2.5" effort="50.0" velocity="2.0"/>

    <xacro:humanoid_link name="${side}_knee_link" mass="2.0">
      <visual_geometry>
        <cylinder radius="0.05" length="0.3"/>
      </visual_geometry>
      <collision_geometry>
        <cylinder radius="0.05" length="0.3"/>
      </collision_geometry>
      <inertial_values>
        <inertial>
          <mass value="2.0"/>
          <inertia ixx="0.01" ixy="0.0" ixz="0.0" iyy="0.01" iyz="0.0" izz="0.005"/>
        </inertial>
      </inertial_values>
    </xacro:humanoid_link>

    <xacro:humanoid_joint name="${side}_ankle_joint" type="revolute"
                          parent="${side}_knee_link" child="${side}_foot_link"
                          origin_xyz="${ankle_xyz}" origin_rpy="0 0 0"
                          axis_xyz="0 0 1" lower="-0.5" upper="0.5" effort="20.0" velocity="1.0"/>

    <xacro:humanoid_link name="${side}_foot_link" mass="1.0">
      <visual_geometry>
        <box size="0.2 0.1 0.05"/>
      </visual_geometry>
      <collision_geometry>
        <box size="0.2 0.1 0.05"/>
      </collision_geometry>
      <inertial_values>
        <inertial>
          <mass value="1.0"/>
          <inertia ixx="0.001" ixy="0.0" ixz="0.0" iyy="0.002" iyz="0.0" izz="0.0015"/>
        </inertial>
      </inertial_values>
    </xacro:humanoid_link>
  </xacro:macro>

  <!-- Macro for humanoid arm -->
  <xacro:macro name="humanoid_arm" params="side shoulder_xyz elbow_xyz wrist_xyz">
    <xacro:humanoid_joint name="${side}_shoulder_joint" type="revolute"
                          parent="torso_link" child="${side}_shoulder_link"
                          origin_xyz="${shoulder_xyz}" origin_rpy="0 0 0"
                          axis_xyz="0 1 0" lower="-1.57" upper="1.57" effort="20.0" velocity="1.5"/>

    <xacro:humanoid_link name="${side}_shoulder_link" mass="1.0">
      <visual_geometry>
        <cylinder radius="0.04" length="0.1"/>
      </visual_geometry>
      <collision_geometry>
        <cylinder radius="0.04" length="0.1"/>
      </collision_geometry>
      <inertial_values>
        <inertial>
          <mass value="1.0"/>
          <inertia ixx="0.002" ixy="0.0" ixz="0.0" iyy="0.002" iyz="0.0" izz="0.001"/>
        </inertial>
      </inertial_values>
    </xacro:humanoid_link>

    <xacro:humanoid_joint name="${side}_elbow_joint" type="revolute"
                          parent="${side}_shoulder_link" child="${side}_elbow_link"
                          origin_xyz="${elbow_xyz}" origin_rpy="0 0 0"
                          axis_xyz="1 0 0" lower="-2.0" upper="2.0" effort="20.0" velocity="1.5"/>

    <xacro:humanoid_link name="${side}_elbow_link" mass="1.5">
      <visual_geometry>
        <cylinder radius="0.03" length="0.25"/>
      </visual_geometry>
      <collision_geometry>
        <cylinder radius="0.03" length="0.25"/>
      </collision_geometry>
      <inertial_values>
        <inertial>
          <mass value="1.5"/>
          <inertia ixx="0.005" ixy="0.0" ixz="0.0" iyy="0.005" iyz="0.0" izz="0.001"/>
        </inertial>
      </inertial_values>
    </xacro:humanoid_link>

    <xacro:humanoid_joint name="${side}_wrist_joint" type="revolute"
                          parent="${side}_elbow_link" child="${side}_hand_link"
                          origin_xyz="${wrist_xyz}" origin_rpy="0 0 0"
                          axis_xyz="0 1 0" lower="-1.57" upper="1.57" effort="10.0" velocity="1.0"/>

    <xacro:humanoid_link name="${side}_hand_link" mass="0.5">
      <visual_geometry>
        <box size="0.1 0.08 0.08"/>
      </visual_geometry>
      <collision_geometry>
        <box size="0.1 0.08 0.08"/>
      </collision_geometry>
      <inertial_values>
        <inertial>
          <mass value="0.5"/>
          <inertia ixx="0.0005" ixy="0.0" ixz="0.0" iyy="0.0006" iyz="0.0" izz="0.0006"/>
        </inertial>
      </inertial_values>
    </xacro:humanoid_link>
  </xacro:macro>

  <!-- Base structure -->
  <link name="base_link">
    <visual>
      <geometry>
        <box size="${body_width} 0.2 ${body_depth}"/>
      </geometry>
      <material name="grey"/>
    </visual>
    <collision>
      <geometry>
        <box size="${body_width} 0.2 ${body_depth}"/>
      </geometry>
    </collision>
    <inertial>
      <mass value="10.0"/>
      <inertia ixx="0.1" ixy="0.0" ixz="0.0" iyy="0.2" iyz="0.0" izz="0.15"/>
    </inertial>
  </link>

  <xacro:humanoid_joint name="torso_joint" type="fixed"
                        parent="base_link" child="torso_link"
                        origin_xyz="0 0 0.1" origin_rpy="0 0 0"
                        axis_xyz="0 0 0" lower="0" upper="0" effort="0" velocity="0"/>

  <link name="torso_link">
    <visual>
      <geometry>
        <box size="${body_width-0.05} 0.15 0.4"/>
      </geometry>
      <material name="orange"/>
    </visual>
    <collision>
      <geometry>
        <box size="${body_width-0.05} 0.15 0.4"/>
      </geometry>
    </collision>
    <inertial>
      <mass value="8.0"/>
      <inertia ixx="0.2" ixy="0.0" ixz="0.0" iyy="0.3" iyz="0.0" izz="0.25"/>
    </inertial>
  </link>

  <!-- Use macros to create limbs -->
  <xacro:humanoid_leg side="left" hip_xyz="-0.1 0 -0.05" knee_xyz="0 0 -0.2" ankle_xyz="0 0 -0.3"/>
  <xacro:humanoid_leg side="right" hip_xyz="0.1 0 -0.05" knee_xyz="0 0 -0.2" ankle_xyz="0 0 -0.3"/>
  <xacro:humanoid_arm side="left" shoulder_xyz="-0.15 0 0.1" elbow_xyz="0 0 -0.15" wrist_xyz="0 0 -0.25"/>
  <xacro:humanoid_arm side="right" shoulder_xyz="0.15 0 0.1" elbow_xyz="0 0 -0.15" wrist_xyz="0 0 -0.25"/>

</robot>
```

## Adding Sensors to Humanoid Models

For perception capabilities, sensors must be properly integrated into the URDF:

```xml
<!-- IMU Sensor in head -->
<gazebo reference="head_link">
  <sensor name="imu_sensor" type="imu">
    <always_on>true</always_on>
    <update_rate>100</update_rate>
    <imu>
      <angular_velocity>
        <x>
          <noise type="gaussian">
            <mean>0.0</mean>
            <stddev>2e-4</stddev>
            <bias_mean>0.0</bias_mean>
            <bias_stddev>0.0000075</bias_stddev>
          </noise>
        </x>
        <y>
          <noise type="gaussian">
            <mean>0.0</mean>
            <stddev>2e-4</stddev>
            <bias_mean>0.0</bias_mean>
            <bias_stddev>0.0000075</bias_stddev>
          </noise>
        </y>
        <z>
          <noise type="gaussian">
            <mean>0.0</mean>
            <stddev>2e-4</stddev>
            <bias_mean>0.0</bias_mean>
            <bias_stddev>0.0000075</bias_stddev>
          </noise>
        </z>
      </angular_velocity>
      <linear_acceleration>
        <x>
          <noise type="gaussian">
            <mean>0.0</mean>
            <stddev>1.7e-2</stddev>
            <bias_mean>0.1</bias_mean>
            <bias_stddev>0.001</bias_stddev>
          </noise>
        </x>
        <y>
          <noise type="gaussian">
            <mean>0.0</mean>
            <stddev>1.7e-2</stddev>
            <bias_mean>0.1</bias_mean>
            <bias_stddev>0.001</bias_stddev>
          </noise>
        </y>
        <z>
          <noise type="gaussian">
            <mean>0.0</mean>
            <stddev>1.7e-2</stddev>
            <bias_mean>0.1</bias_mean>
            <bias_stddev>0.001</bias_stddev>
          </noise>
        </z>
      </linear_acceleration>
    </imu>
    <plugin name="imu_plugin" filename="libgazebo_ros_imu_sensor.so">
      <ros>
        <namespace>/humanoid</namespace>
        <remapping>~/out:=imu/data</remapping>
      </ros>
      <initial_orientation_as_reference>false</initial_orientation_as_reference>
    </plugin>
  </sensor>
</gazebo>

<!-- RGB-D Camera in head -->
<gazebo reference="head_link">
  <sensor name="rgbd_camera" type="depth">
    <always_on>true</always_on>
    <update_rate>30</update_rate>
    <pose>0.1 0 0.05 0 0 0</pose>
    <camera name="head_camera">
      <horizontal_fov>1.047</horizontal_fov>
      <image>
        <width>640</width>
        <height>480</height>
        <format>R8G8B8</format>
      </image>
      <clip>
        <near>0.1</near>
        <far>10.0</far>
      </clip>
    </camera>
    <plugin name="camera_controller" filename="libgazebo_ros_openni_kinect.so">
      <alwaysOn>true</alwaysOn>
      <updateRate>30.0</updateRate>
      <cameraName>head_camera</cameraName>
      <imageTopicName>rgb/image_raw</imageTopicName>
      <depthImageTopicName>depth/image_raw</depthImageTopicName>
      <pointCloudTopicName>depth/points</pointCloudTopicName>
      <cameraInfoTopicName>rgb/camera_info</cameraInfoTopicName>
      <depthImageCameraInfoTopicName>depth/camera_info</depthImageCameraInfoTopicName>
      <frameName>head_camera_depth_optical_frame</frameName>
      <baseline>0.1</baseline>
      <distortion_k1>0.0</distortion_k1>
      <distortion_k2>0.0</distortion_k2>
      <distortion_k3>0.0</distortion_k3>
      <distortion_t1>0.0</distortion_t1>
      <distortion_t2>0.0</distortion_t2>
      <pointCloudCutoff>0.5</pointCloudCutoff>
      <pointCloudCutoffMax>3.0</pointCloudCutoffMax>
      <CxPrime>0.0</CxPrime>
      <Cx>320.5</Cx>
      <Cy>240.5</Cy>
      <focalLength>320.0</focalLength>
    </plugin>
  </sensor>
</gazebo>

<!-- LiDAR Sensor in torso -->
<gazebo reference="torso_link">
  <sensor name="lidar" type="ray">
    <always_on>true</always_on>
    <update_rate>10</update_rate>
    <pose>0.0 0.0 0.2 0 0 0</pose>
    <ray>
      <scan>
        <horizontal>
          <samples>360</samples>
          <resolution>1</resolution>
          <min_angle>-3.14159</min_angle>
          <max_angle>3.14159</max_angle>
        </horizontal>
      </scan>
      <range>
        <min>0.1</min>
        <max>10.0</max>
        <resolution>0.01</resolution>
      </range>
    </ray>
    <plugin name="lidar_controller" filename="libgazebo_ros_ray_sensor.so">
      <ros>
        <namespace>/humanoid</namespace>
        <remapping>~/out:=scan</remapping>
      </ros>
      <output_type>sensor_msgs/LaserScan</output_type>
    </plugin>
  </sensor>
</gazebo>
```

## Validation and Testing

Proper validation of humanoid models is crucial:

```bash
# Validate URDF
check_urdf /path/to/humanoid.urdf

# Visualize in RViz
ros2 run rviz2 rviz2

# Test kinematics
ros2 run moveit_ros_planners_ompl ompl_planning_pipeline_demo

# Check joint limits
ros2 launch moveit_configs_utils moveit_rviz.launch.py
```

## Practical Exercise

1. Create a humanoid model with 28+ degrees of freedom
2. Add sensors (IMU, camera, LiDAR) to the model
3. Validate the kinematic chain
4. Test joint limits and range of motion

## Summary

URDF and Xacro are fundamental tools for creating humanoid robot models. Proper modeling requires attention to kinematic chains, inertial properties, joint limits, and sensor integration. Xacro macros enable parametric design for easier customization and maintenance of complex humanoid models.